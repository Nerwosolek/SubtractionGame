var game;var lang="pl";var who_plays;var startPanel;var statusPanel;var ballsNumber=12;var currentBallsNumber=ballsNumber;var ballsMoveNbr=2;var currentBalls;var bomb;var ballSrc="img/beach-ball-4.png";var ballInvSrc="img/beach-ball-4inv.png";var ballCmpSrc="img/beach-ball-4cmp.png";var bombSrc="img/bomb.png";var gameBalls;function bombMouseoutHandler(){currentBalls[currentBalls.length-1].className="ball";for(var a=0;a<currentBalls.length-1;a=a+1){currentBalls[a].src=ballSrc}updatePanelChoice(0)}function bombMouseoverHandler(){currentBalls[currentBalls.length-1].className="ball96";for(var a=0;a<currentBalls.length-1;a=a+1){currentBalls[a].src=ballInvSrc}updatePanelChoice(currentBalls.length)}function ballMouseoutHandler(){var a=0;while(currentBalls[a]!=this){currentBalls[a].src=ballSrc;a=a+1}this.src=ballSrc;updatePanelChoice(0)}function ballMouseoverHandler(){var a=0;while(currentBalls[a]!=this){currentBalls[a].src=ballInvSrc;a=a+1}this.src=ballInvSrc;updatePanelChoice(a+1)}function ballClickHandler(){var a=0;while(currentBalls[a]!=this){a=a+1}chooseBalls(a+1)}function prepareGame(a,b){game=a;lang=b}function startGame(c){if(c==0){who_plays="c"}else{who_plays="p"}vStatusPanelTitle=document.getElementById("gameStatusTitle");vStatusPanelInfo=document.getElementById("gameStatusInfo");vStatusPanelChoice=document.getElementById("gameStatusChoice");startPanel=document.getElementById("startPanel");ballsNumber=Number(document.getElementById("totalBallsNbr").value);currentBallsNumber=ballsNumber;ballsMoveNbr=Number(document.getElementById("ballsMoveNbr").value);game.removeChild(startPanel);gameBalls=document.getElementById("balls-col");currentBalls=new Array(ballsNumber);for(var a=1;a<ballsNumber;a++){var b=createBall();gameBalls.appendChild(b);currentBalls[a-1]=b}bomb=createBomb();gameBalls.appendChild(bomb);currentBalls[ballsNumber-1]=bomb;if(who_plays=="c"){computerMoves()}else{if(who_plays=="p"){playerMoves()}}}function createBall(){var a=new Image();a.src=ballSrc;a.classList.add("ball");return a}function createBomb(){var a=new Image();a.src=bombSrc;a.classList.add("ball");return a}function endTurn(){if(who_plays=="p"){if(currentBalls.length==0){switch(lang){case"en":vStatusPanelTitle.innerHTML="You LOST!";break;default:vStatusPanelTitle.innerHTML="Przegrałeś!";break}updatePanelInfo();updatePanelChoice();endGame();return}who_plays="c";computerMoves()}else{if(currentBalls.length==0){switch(lang){case"en":vStatusPanelTitle.innerHTML="You WON!";break;default:vStatusPanelTitle.innerHTML="Wygrałeś!";break}updatePanelInfo();updatePanelChoice();endGame();return}who_plays="p";playerMoves()}}function playerMoves(){updatePanelChoice(0);updatePanelInfo(currentBalls.length);switch(lang){case"en":vStatusPanelTitle.innerHTML="Your move...";break;default:vStatusPanelTitle.innerHTML="Twój ruch...";break}for(var a=0;a<Math.min(currentBalls.length,ballsMoveNbr);a=a+1){if(a==currentBalls.length-1){currentBalls[a].addEventListener("click",ballClickHandler);currentBalls[a].addEventListener("mouseover",bombMouseoverHandler);currentBalls[a].addEventListener("mouseout",bombMouseoutHandler)}else{currentBalls[a].addEventListener("click",ballClickHandler);currentBalls[a].addEventListener("mouseover",ballMouseoverHandler);currentBalls[a].addEventListener("mouseout",ballMouseoutHandler)}}}function chooseBalls(b){for(var a=0;a<b;a++){if(a==currentBalls.length-1){currentBalls[a].removeEventListener("mouseout",bombMouseoutHandler)}else{currentBalls[a].removeEventListener("mouseover",ballMouseoverHandler);currentBalls[a].removeEventListener("mouseout",ballMouseoutHandler)}currentBalls[a].removeEventListener("click",ballClickHandler);gameBalls.removeChild(currentBalls[a])}currentBalls=currentBalls.slice(b);endTurn()}function computerMoves(){switch(lang){case"en":vStatusPanelTitle.innerHTML="Computer moves";break;default:vStatusPanelTitle.innerHTML="Ruch komputera";break}updatePanelInfo(currentBalls.length);var c=currentBalls.length;if(c>1){var d=c%(ballsMoveNbr+1);if(d==0){for(var a=0;a<ballsMoveNbr;a=a+1){currentBalls[a].src=ballCmpSrc}updatePanelChoice(ballsMoveNbr);setTimeout(function(){chooseBalls(ballsMoveNbr)},1500)}if(d==1){var b=Math.floor(Math.random()*ballsMoveNbr)+1;for(var a=0;a<b;a=a+1){currentBalls[a].src=ballCmpSrc}updatePanelChoice(b);setTimeout(function(){chooseBalls(b)},1500)}if(d>1){for(var a=0;a<(d-1);a=a+1){currentBalls[a].src=ballCmpSrc}updatePanelChoice(d-1);setTimeout(function(){chooseBalls(d-1)},1500)}}else{if(c==1){currentBalls[0].className="ball96";updatePanelChoice(1);setTimeout(function(){chooseBalls(1)},1500)}}}function endGame(){switch(lang){case"en":againButton='<button type="button" class="btn btn-primary btn-lg" onclick="resetGame()">Play again?</button>';break;default:againButton='<button type="button" class="btn btn-primary btn-lg" onclick="resetGame()">Jeszcze raz?</button>';break}gameBalls.innerHTML=againButton;gameBalls.className="col-xs-12 again"}function resetGame(){switch(lang){case"en":gameTitle='<h1 id="gameTitle">SUBTRACTION: The Game</h1>';break;default:gameTitle='<h1 id="gameTitle">Gra w odejmowanie</h1>';break}gameBalls.innerHTML="";game.appendChild(startPanel);vStatusPanelTitle.innerHTML=gameTitle;vStatusPanelInfo.innerHTML="";updatePanelChoice();gameBalls.className="balls-row col-xs-12"}function updatePanelChoice(a){if(a!=undefined){switch(lang){case"en":if(a==1){vStatusPanelChoice.innerHTML=a+" ball highlighted."}else{vStatusPanelChoice.innerHTML=a+" balls highlighted."}break;default:if(a==1){vStatusPanelChoice.innerHTML="Zaznaczyłeś "+a+" piłeczkę."}else{if(a>1&&a<5){vStatusPanelChoice.innerHTML="Zaznaczyłeś "+a+" piłeczki."}else{vStatusPanelChoice.innerHTML="Zaznaczyłeś "+a+" piłeczek."}}break}}else{vStatusPanelChoice.innerHTML=""}}function updatePanelInfo(a){if(a!=undefined){switch(lang){case"en":if(a==1){vStatusPanelInfo.innerHTML=a+" ball left"}else{vStatusPanelInfo.innerHTML=a+" balls left"}break;default:if(a==1){vStatusPanelInfo.innerHTML="Została "+a+" piłeczka."}else{if(a>1&&a<5){vStatusPanelInfo.innerHTML="Zostały "+a+" piłeczki."}else{vStatusPanelInfo.innerHTML="Zostało "+a+" piłeczek."}}break}}else{vStatusPanelInfo.innerHTML=""}};